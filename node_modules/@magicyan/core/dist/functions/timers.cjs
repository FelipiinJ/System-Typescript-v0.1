'use strict';

const promises = require('node:timers/promises');

function createInterval(options) {
  const { time, run } = options;
  const timer = setInterval(() => {
    run(() => clearInterval(timer));
  }, time);
  return { timer, stop: () => clearInterval(timer) };
}
function createTimeout(options) {
  const { delay: time, run } = options;
  const timer = setTimeout(() => run(), time);
  return { timer, stop: () => clearTimeout(timer) };
}
function createLoopInterval(options) {
  const { run, time, array } = options;
  let lap = 0;
  let loop = 0;
  return createInterval({
    time,
    run(stop) {
      if (loop === array.length) {
        lap++;
        loop = 0;
      }
      run(array[loop], stop, lap, array);
      loop++;
    }
  });
}

exports.sleep = promises.setTimeout;
exports.createInterval = createInterval;
exports.createLoopInterval = createLoopInterval;
exports.createTimeout = createTimeout;
